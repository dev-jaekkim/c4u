<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="mybatis.ReviewMapper">

<resultMap id="resultmap" type="Notice" >
	<result property="noticeId" column="notice_id"/>
	<result property="noticeTitle" column="notice_title"/>
	<result property="noticeDate" column="notice_date"/>
	<result property="noticeContent" column="notice_content"/>
</resultMap>


<select id="selectPerPage" parameterType = "java.util.Map" resultMap="resultmap">
SELECT * 
FROM (
	  SELECT notice_id, notice_title, notice_date, notice_content, row_number() OVER(ORDER BY notice_id DESC) AS rnum 
	  FROM notice
	  )
WHERE rnum BETWEEN fun_start_row(#{currentPage}, #{cnt_per_page}) AND fun_end_row(#{currentPage}, #{cnt_per_page})
</select>

<select id="selectCnt" resultType="int">
SELECT COUNT(*)
FROM notice
</select>

<select id="selectByTitlePerPage" parameterType="java.util.HashMap" resultMap="resultmap">
SELECT * FROM 
            (SELECT notice_id, notice_title, notice_date, notice_content, row_number() OVER (ORDER BY notice_id DESC) AS rnum 
            FROM notice
            WHERE notice_title LIKE '%${notice_title}%') 
WHERE rnum BETWEEN fun_start_row(#{currentPage},#{cnt_per_page}) AND fun_end_row(#{currentPage},#{cnt_per_page})
</select>


<select id="selectById" parameterType="int" resultMap="resultmap">
SELECT *
FROM notice
WHERE notice_id = #{notice_id} 
</select>

<update id="update" parameterType="Notice">
UPDATE notice
<set>
	<if test="noticeTitle !=null">notice_title=#{noticeTitle},</if>
	<if test="noticeContent !=null">notice_content=#{noticeContent}</if>
</set>
<where>
	notice_id = #{noticeId}
</where>
</update>

<delete id="delete" parameterType="int">
DELETE notice
WHERE notice_id = #{notice_id}
</delete>

<insert id="insert" parameterType="Notice">
INSERT INTO notice (notice_id, notice_title, notice_date, notice_content)
            VALUES (seq_notice_id.NEXTVAL, #{noticeTitle}, SYSDATE, #{noticeContent})
</insert>

</mapper>